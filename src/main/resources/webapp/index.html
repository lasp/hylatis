<html>
  <head>
    <title>Hylatis</title>

    <style>
     .outer {
       display: inline;
     }

     .rgb-box span {
       display: inline-block;
       width: 15px;
     }

     .no-border {
       border: none;
     }

     .invisible {
       display: none;
     }
    </style>

    <script>
     window.onload = function () {
       document.getElementById("sub").onclick = function () {
         const r = document.getElementById("r").value;
         const g = document.getElementById("g").value;
         const b = document.getElementById("b").value;

         const latN = document.getElementById("lat-n").value;
         const latS = document.getElementById("lat-s").value;
         const lonE = document.getElementById("lon-e").value;
         const lonW = document.getElementById("lon-w").value;

         const spacecraft =
           document.querySelector("input[name=spacecraft]:checked").value;
         const nPx = 1e5;

         const root = `/latis-hylatis/dap/${spacecraft}.png`;

         // Assuming RGB are given.
         const rgb = `rgbPivot(wavelength,${r},${g},${b})`;

         // The bounding box is optional.
         const boxDefined =
           [latN, latS, lonE, lonW].every(x => x.length > 0);
         const useBox = boxDefined && spacecraft == "goes";
         const box = (useBox) ? `&bbox(${lonW},${latS},${lonE},${latN},${nPx})` : "";

         const url = `${root}?${rgb}${box}`;
         window.location.href = url;
       };

       showBndBox = function () {
         document.getElementById("bnd-box").classList.remove("invisible")
       };

       hideBndBox = function () {
         document.getElementById("bnd-box").classList.add("invisible")
       };

       // Show bounding box selection if GOES is selected.
       document.getElementById("goes").onchange = showBndBox;

       // Hide bounding box selection if HySICS is selected.
       document.getElementById("hysics").onchange = hideBndBox;

       // Show the box if we start with GOES checked. (Happens if you
       // press back after making a GOES image.)
       if (document.querySelector("input[name=spacecraft]:checked").value == "goes") {
         document.getElementById("bnd-box").classList.remove("invisible");
       }
     };
    </script>
  </head>
  <body>
    <h1>Hylatis</h1>
    <fieldset class="outer">
      <legend>RGB Image</legend>

      <fieldset>
        <legend>Spacecraft</legend>

        <label for="hysics">HySICS</label>
        <input type="radio" id="hysics" value="hysics" name="spacecraft" checked>

        <label for="goes">GOES</label>
        <input type="radio" id="goes" value="goes" name="spacecraft">
      </fieldset>

      <fieldset class="rgb-box">
        <legend>RGB Wavelengths</legend>

        <div>
          <span>R</span>
          <input id="r" type="number" min="0">
          <label for="r">nm</label>
        </div>

        <div>
          <span>G</span>
          <input id="g" type="number" min="0">
          <label for="g">nm</label>
        </div>

        <div>
          <span>B</span>
          <input id="b" type="number" min="0">
          <label for="b">nm</label>
        </div>
      </fieldset>

      <fieldset id="bnd-box" class="invisible">
        <legend>Bounding Box</legend>

        <fieldset class="no-border">
          <legend>NW Corner</legend>

          <input id="lat-n" type="number">
          <label for="lat-n">째N</label>

          <input id="lon-w" type="number">
          <label for="lon-w">째E</label>
        </fieldset>

        <fieldset class="no-border">
          <legend>SE Corner</legend>

          <input id="lat-s" type="number">
          <label for="lat-s">째N</label>

          <input id="lon-e" type="number">
          <label for="lon-e">째E</label>
        </fieldset>
      </fieldset>
      <br>

      <button type="button" id="sub">Generate</button>
    </fieldset>
  </body>
</html>
